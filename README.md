# Домашнее задание к занятию "`Очереди RabbitMQ`" - `Дёмин Максим`


### Задание 1

Что нужно сделать:

Установка RabbitMQ

Используя Vagrant или VirtualBox, создайте виртуальную машину и установите RabbitMQ. Добавьте management plug-in и зайдите в веб-интерфейс.

### Решение:

1. запускаем [Vagrant](img/01.png) ``` vagrant up``` ([vagrant](script/Vagrantfile) [provision.sh](script/provision.sh))

2. заходим на [веб интерфейс](img/02.png) [2](img/03.png) [3](img/04.png) 


### Задание 2

Что нужно сделать:

Отправка и получение сообщений

Используя приложенные скрипты, проведите тестовую отправку и получение сообщения. Для отправки сообщений необходимо запустить скрипт producer.py.

Для работы скриптов вам необходимо установить Python версии 3 и библиотеку Pika. Также в скриптах нужно указать IP-адрес машины, на которой запущен RabbitMQ, заменив localhost на нужный IP.

Зайдите в веб-интерфейс, найдите очередь под названием hello и сделайте скриншот. После чего запустите второй скрипт consumer.py и сделайте скриншот результата выполнения скрипта

### Решение:

1. Запускаем [скрипт отправки сообщения](img/05.png) [producer.py](script/producer.py)

2. заходим в веб интерфейс в раздел [очереди](img/06.png)

3. нажимаем [получить сообщение](img/07.png)

4. запускаем скрипт для [получения сообщения](img/08.png) [consumer.py](script/consumer.py)

5. проверяем на веб интерфейсе что сообщение удалено из [очереди](img/09.png)

img/10.png
img/11.png


### Задание 3

Что нужно сделать:

 Подготовка HA кластера
 
Используя Vagrant или VirtualBox, создайте вторую виртуальную машину и установите RabbitMQ. Добавьте в файл hosts название и IP-адрес каждой машины, чтобы машины могли видеть друг друга по имени.

Пример содержимого hosts файла:

```
$ cat /etc/hosts
192.168.0.10 rmq01
192.168.0.11 rmq02
```
После этого ваши машины могут пинговаться по имени.

Затем объедините две машины в кластер и создайте политику ha-all на все очереди.

В качестве решения домашнего задания приложите скриншоты из веб-интерфейса с информацией о доступных нодах в кластере и включённой политикой.

Также приложите вывод команды с двух нод:

```
$ rabbitmqctl cluster_status
```
Для закрепления материала снова запустите скрипт producer.py и приложите скриншот выполнения команды на каждой из нод:

```
$ rabbitmqadmin get queue='hello'
```

После чего попробуйте отключить одну из нод, желательно ту, к которой подключались из скрипта, затем поправьте параметры подключения в скрипте consumer.py на вторую ноду и запустите его.

### Решение:



### Задание 4

Что нужно сделать:

Ansible playbook

Напишите плейбук, который будет производить установку RabbitMQ на любое количество нод и объединять их в кластер. При этом будет автоматически создавать политику ha-all.


### Решение:


